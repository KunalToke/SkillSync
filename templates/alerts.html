{% extends "base.html" %}
{% block content %}
<div class="job-alerts-container">
    <h2 class="page-title">üî• Latest Job Alerts</h2>

    <!-- üîç Search + Filter Bar -->
    <form method="get" class="search-filter-form">
        <input type="text" name="search" placeholder="Search jobs (e.g. Python, Data)" value="{{ request.args.get('search', '') }}">
        <select name="company">
            <option value="">All Companies</option>
            {% for company in jobs_by_company.keys() %}
                <option value="{{ company }}" {% if request.args.get('company') == company %}selected{% endif %}>{{ company }}</option>
            {% endfor %}
        </select>
        <select name="location">
            <option value="">All Locations</option>
            {% for company, job_list in jobs_by_company.items() %}
                {% for job in job_list %}
                    <option value="{{ job.location }}" {% if request.args.get('location') == job.location %}selected{% endif %}>
                        {{ job.location }}
                    </option>
                {% endfor %}
            {% endfor %}
        </select>
        <button type="submit">Apply Filters</button>
    </form>

    <!-- üìå Jobs grouped by company -->
    {% for company, job_list in jobs_by_company.items() %}
        <div class="company-section">
            <h3 class="company-title">{{ company }}</h3>
            <div class="jobs-grid">
                {% for job in job_list %}
                <div class="job-card">
                    <h4>{{ job.title }}</h4>
                    <p class="job-location">üìç {{ job.location }}</p>
                    <a href="{{ job.url }}" target="_blank" class="apply-btn">Apply Now</a>
                </div>
                {% endfor %}
            </div>
        </div>
    {% endfor %}
</div>
{% endblock %}
