{% extends "base.html" %}
{% block title %}SkillSync | Talent Seekers Dashboard{% endblock %}
{% block content %}
<div class="container my-5">
  <h2 class="text-center mb-4">
    <i class="fa-solid fa-chart-line"></i> SkillSync Talent Seekers Dashboard
  </h2>

  <div class="row g-4">
    <!-- Quick Stats -->
    <div class="col-md-12">
      <div class="card shadow-lg border-0">
        <div class="card-header bg-primary text-white">
          <i class="fa-solid fa-gauge"></i> Quick Stats Panel
        </div>
        <div class="card-body d-flex justify-content-around flex-wrap text-center">
          <div><h4>{{ stats.total_jobs }}</h4><p>Jobs Posted</p></div>
          <div><h4>{{ stats.total_candidates }}</h4><p>Candidates</p></div>
          <div><h4>{{ stats.applications_received }}</h4><p>Applications</p></div>
          <div><h4>{{ stats.avg_match_score }}%</h4><p>Avg Match Score</p></div>
        </div>
      </div>
    </div>

    <!-- Recent Applications -->
    <div class="col-md-6">
      <div class="card shadow-lg border-0">
        <div class="card-header bg-info text-white">
          <i class="fa-solid fa-inbox"></i> Recent Applications Feed
        </div>
        <div class="card-body">
          <ul class="list-group">
            {% for a in applications %}
              <li class="list-group-item">
                <b>{{ a.candidate }}</b> applied for <i>{{ a.job }}</i>
                <span class="badge bg-primary">{{ a.status }}</span>
              </li>
            {% endfor %}
          </ul>
        </div>
      </div>
    </div>

    <!-- Top Matches -->
    <div class="col-md-6">
      <div class="card shadow-lg border-0">
        <div class="card-header bg-success text-white">
          <i class="fa-solid fa-user-check"></i> Top Candidate Matches
        </div>
        <div class="card-body">
          <ul class="list-group">
            {% for m in matches %}
              <li class="list-group-item">
                {{ m.name }} – <b>{{ m.match }}%</b> fit ({{ m.skills }})
              </li>
            {% endfor %}
          </ul>
        </div>
      </div>
    </div>

    <!-- Hiring Pipeline -->
    <div class="col-md-12">
      <div class="card shadow-lg border-0">
        <div class="card-header bg-warning">
          <i class="fa-solid fa-columns"></i> Hiring Pipeline
        </div>
        <div class="card-body d-flex justify-content-between flex-wrap">
          {% for stage, people in pipeline.items() %}
            <div class="border p-2 rounded mb-2" style="width: 22%;">
              <h6>{{ stage }}</h6>
              <ul class="list-unstyled">
                {% for p in people %}
                  <li><i class="fa-solid fa-user"></i> {{ p }}</li>
                {% else %}
                  <li class="text-muted">No one yet</li>
                {% endfor %}
              </ul>
            </div>
          {% endfor %}
        </div>
      </div>
    </div>

    <!-- Analytics -->
    <div class="col-md-6">
      <div class="card shadow-lg border-0">
        <div class="card-header bg-secondary text-white">
          <i class="fa-solid fa-chart-pie"></i> Recruitment Analytics
        </div>
        <div class="card-body">
          <canvas id="analyticsChart"></canvas>
        </div>
      </div>
    </div>

    <!-- Tasks -->
    <div class="col-md-6">
      <div class="card shadow-lg border-0">
        <div class="card-header bg-danger text-white">
          <i class="fa-solid fa-list-check"></i> Pending Tasks
        </div>
        <div class="card-body">
          <ul class="list-group">
            {% for t in tasks %}
              <li class="list-group-item">{{ t.task }} – <i>{{ t.due }}</i></li>
            {% endfor %}
          </ul>
        </div>
      </div>
    </div>

    <!-- Market Trends -->
    <div class="col-md-6">
      <div class="card shadow-lg border-0">
        <div class="card-header bg-primary text-white">
          <i class="fa-solid fa-satellite-dish"></i> Talent Market Radar
        </div>
        <div class="card-body">
          <ul class="list-group">
            {% for trend in market %}
              <li class="list-group-item">{{ trend.trend }}</li>
            {% endfor %}
          </ul>
        </div>
      </div>
    </div>
  </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script>
  const ctx = document.getElementById('analyticsChart').getContext('2d');
  new Chart(ctx, {
    type: 'doughnut',
    data: {
      labels: ['Jobs', 'Candidates', 'Applications'],
      datasets: [{
        data: [{{ stats.total_jobs }}, {{ stats.total_candidates }}, {{ stats.applications_received }}],
        backgroundColor: ['#0d6efd', '#198754', '#ffc107']
      }]
    }
  });
</script>
{% endblock %}
